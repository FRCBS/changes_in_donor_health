---
title: "Inital data analysis for FINDONOR- CHANGES IN SELF-RATED HEALTH DURING THE STUDY AND IT'S RELATION TO IRON BIOMARKERS "
author: "Mikko Arvasr"
date: "`r format(Sys.time(), '%d %B, %Y')`"
output: html_document
    df_print: paged

---



```{r setup, include=FALSE}
knitr::opts_chunk$set(
	echo = TRUE,
	message = FALSE,
	warning = FALSE
)
library(tidyverse)
#library(epitools)
#library(ez)
library(lubridate)
#library(ggbeeswarm)
#library(tidymodels)
#library(broom)
#library(GGally)
#library(ggfortify)
#library(car)
#library(boot)
```

# Executive summary


In this file we carry out inital data analysis to look at explenatory variables in the questionaire data. blaablaablaa

1. Look for correlation between variables.

# Load the data

We load the data and assign groups as they were assigned in the first part of the study. 

```{r loading}
#Load questionnaire data
load(file = "../data/final_data.rdata") 

```

# How much data do we have
```{r}
#drop out variables that, 
# we know from our previous work are too messy: iron_supp_detailed
# were only asked in second questionaire: life_qual, education, employment
# are conveniency variables: AgeGroup, SixMonthsFromStartCount_FB, TwoYearsFromStartCount_FB
temp <- data %>% select(-iron_supp_detailed, -life_qual, -education, -employment,-AgeGroup, -SixMonthsFromStartCount_FB,-TwoYearsFromStartCount_FB)
temp <- na.omit(temp)
temp %>% group_by(questionnaire) %>% count()
```

As we will loose most of our data if we study only complete data we have try to make decisions on which questions to exclude prior to analyses.

```{r}
temp <- data %>% select(-iron_supp_detailed, -life_qual, -education, -employment,-AgeGroup, -SixMonthsFromStartCount_FB,-TwoYearsFromStartCount_FB)
temp <- temp %>% group_by(questionnaire) %>%  summarise_all(funs(sum(is.na(.))))
temp <- as_tibble(t(temp), rownames = "Variable") %>% filter(Variable != "questionnaire")
colnames(temp)[2] <- "First"
colnames(temp)[3] <- "Second"
temp <- temp %>%  gather(key="questionnaire",value="NAs",-Variable) %>% mutate(NAs = as.numeric(gsub(" ","",NAs)))

ggplot(temp) + geom_col(aes(x=Variable,y=NAs,fill=questionnaire),pos="dodge") +  coord_flip() 

```

I NEED TO GO BACK TO PRE_Ida AND CHECK IRON_SUP AND ANEMIA HISTORY, THEY MUST BE CODED WRONG!

# Correlations between variables



